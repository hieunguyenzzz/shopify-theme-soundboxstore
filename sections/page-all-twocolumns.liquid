<div class="page-width">
  <div class="grid-item-wrap">
    {%- assign product  = section.settings.left_product -%}
    {%- liquid
      assign fixed_aspect_ratio = false
      unless settings.product_grid_image_size == 'natural'
        assign fixed_aspect_ratio = true
      endunless

      assign preview_image = product.featured_media.preview_image
      assign img_url = preview_image | img_url: '1x1' | replace: '_1x1.', '_{width}x.'
    -%}
    <div class="product-image-wrap">
      <a
        href="#"
        class="grid-item__link"
      >
        <div class="grid-product__image-wrap">
          {%- if fixed_aspect_ratio -%}
            <div
              class="grid__image-ratio grid__image-ratio--square grid__image-ratio_hide"
              data-count=""
              {{ product.images.size }}
            >
              <img
                class="lazyload"
                data-src="{{ img_url }}"
                data-widths="[160, 200, 280, 360, 540, 720, 900]"
                data-aspectratio="1.0"
                data-sizes="auto"
                alt="{{ preview_image.alt | escape }}"
              >
              <noscript>
                <img
                  class="grid-product__image lazyloaded"
                  src="{{ preview_image | img_url: '400x' }}"
                  alt="{{ preview_image.alt | escape }}"
                >
              </noscript>
            </div>
          {%- else -%}
            {%- liquid
              assign ratio = 1
              if preview_image != blank
                assign ratio = preview_image.aspect_ratio
              endif
            -%}
            <div style="height: 0; padding-bottom: {{ 100 | divided_by: ratio }}%;">
              <img
                class="grid-product__image lazyload"
                data-src="{{ img_url }}"
                data-widths="[360, 540, 720, 900, 1080]"
                data-aspectratio="{{ preview_image.aspect_ratio }}"
                data-sizes="auto"
                alt="{{ preview_image.alt | escape }}"
              >
              <noscript>
                <img
                  class="grid-product__image lazyloaded"
                  src="{{ preview_image | img_url: '400x' }}"
                  alt="{{ preview_image.alt | escape }}"
                >
              </noscript>
            </div>
          {%- endif -%}

          {%- if product.media.size > 1 -%}
            {% if product.metafields.my_fields.product_features_images != blank %}
              {%- assign second_image = product.metafields.my_fields.product_features_images -%}
              <div class="grid-product__secondary-image small--hide">
                {%- assign img_url = second_image -%}
                <img
                  class="lazyload"
                  data-src="{{ img_url }}"
                  data-widths="[360, 540, 720, 1000]"
                  data-aspectratio="{{ second_image.aspect_ratio }}"
                  data-sizes="auto"
                  alt="{{ second_image.alt }}"
                >
              </div>
            {% else %}
              {%- for media in product.media offset: 1 limit: 1 -%}
                {%- assign second_image = media.preview_image -%}
              {%- endfor -%}
              <div class="grid-product__secondary-image small--hide">
                {%- assign img_url = second_image | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
                <img
                  class="lazyload"
                  data-src="{{ img_url }}"
                  data-widths="[360, 540, 720, 1000]"
                  data-aspectratio="{{ second_image.aspect_ratio }}"
                  data-sizes="auto"
                  alt="{{ second_image.alt }}"
                >
              </div>
            {% endif %}
          {%- endif -%}
        </div>
      </a>
      <h3>{{ section.settings.left_content }}</h3>
      <a
        id="{{section.settings.left_button_id}}"
        type="button"
        target="_blank"
        href="{{section.settings.left_button_file}}"
        class="btn btn--secondary specBtn dsd"
      >
        {{ section.settings.left_button }}
      </a>
    </div>

    {%- assign product  = section.settings.right_product -%}
    {%- liquid
      assign fixed_aspect_ratio = false
      unless settings.product_grid_image_size == 'natural'
        assign fixed_aspect_ratio = true
      endunless

      assign preview_image = product.featured_media.preview_image
      assign img_url = preview_image | img_url: '1x1' | replace: '_1x1.', '_{width}x.'
    -%}
    <div class="product-image-wrap">
      <a
        href="#"
        class="grid-item__link"
      >
        <div class="grid-product__image-wrap">
          {%- if fixed_aspect_ratio -%}
            <div
              class="grid__image-ratio grid__image-ratio--square grid__image-ratio_hide"
              data-count=""
              {{ product.images.size }}
            >
              <img
                class="lazyload"
                data-src="{{ img_url }}"
                data-widths="[160, 200, 280, 360, 540, 720, 900]"
                data-aspectratio="1.0"
                data-sizes="auto"
                alt="{{ preview_image.alt | escape }}"
              >
              <noscript>
                <img
                  class="grid-product__image lazyloaded"
                  src="{{ preview_image | img_url: '400x' }}"
                  alt="{{ preview_image.alt | escape }}"
                >
              </noscript>
            </div>
          {%- else -%}
            {%- liquid
              assign ratio = 1
              if preview_image != blank
                assign ratio = preview_image.aspect_ratio
              endif
            -%}
            <div style="height: 0; padding-bottom: {{ 100 | divided_by: ratio }}%;">
              <img
                class="grid-product__image lazyload"
                data-src="{{ img_url }}"
                data-widths="[360, 540, 720, 900, 1080]"
                data-aspectratio="{{ preview_image.aspect_ratio }}"
                data-sizes="auto"
                alt="{{ preview_image.alt | escape }}"
              >
              <noscript>
                <img
                  class="grid-product__image lazyloaded"
                  src="{{ preview_image | img_url: '400x' }}"
                  alt="{{ preview_image.alt | escape }}"
                >
              </noscript>
            </div>
          {%- endif -%}

          {%- if product.media.size > 1 -%}
            {% if product.metafields.my_fields.product_features_images != blank %}
              {%- assign second_image = product.metafields.my_fields.product_features_images -%}
              <div class="grid-product__secondary-image small--hide">
                {%- assign img_url = second_image -%}
                <img
                  class="lazyload"
                  data-src="{{ img_url }}"
                  data-widths="[360, 540, 720, 1000]"
                  data-aspectratio="{{ second_image.aspect_ratio }}"
                  data-sizes="auto"
                  alt="{{ second_image.alt }}"
                >
              </div>
            {% else %}
              {%- for media in product.media offset: 1 limit: 1 -%}
                {%- assign second_image = media.preview_image -%}
              {%- endfor -%}
              <div class="grid-product__secondary-image small--hide">
                {%- assign img_url = second_image | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
                <img
                  class="lazyload"
                  data-src="{{ img_url }}"
                  data-widths="[360, 540, 720, 1000]"
                  data-aspectratio="{{ second_image.aspect_ratio }}"
                  data-sizes="auto"
                  alt="{{ second_image.alt }}"
                >
              </div>
            {% endif %}
          {%- endif -%}
        </div>
      </a>
      <h3>{{ section.settings.right_content }}</h3>
      <button
        d="{{section.settings.right_button_id}}"
        type="button"
        href="{{section.settings.right_button_file}}"
        class="btn btn--secondary specBtn"
      >
        {{ section.settings.right_button }}
      </button>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Page all two columns",
  "settings": [
    {
      "type": "header",
      "content": "Left"
    },
    {
      "type": "product",
      "id": "left_product",
      "label": "Product"
    },
    {
      "type": "text",
      "id": "left_content",
      "label": "Content",
      "default": "Download assembly instructions for solo pod"
    },
    {
      "type": "text",
      "id": "left_button",
      "label": "Button text",
      "default": "Download here"
    },
    {
      "type": "text",
      "id": "left_button_id",
      "label": "Button id",
      "default": "left_button"
    },
    {
      "type": "text",
      "id": "left_button_file",
      "label": "File url",
      "default": "/"
    },
    {
      "type": "header",
      "content": "Right"
    },
    {
      "type": "product",
      "id": "right_product",
      "label": "Product"
    },
    {
      "type": "text",
      "id": "right_content",
      "label": "Content",
      "default": "Download assembly instructions for multiple slots pod"
    },
    {
      "type": "text",
      "id": "right_button",
      "label": "Button text",
      "default": "Download here"
    },
    {
      "type": "text",
      "id": "right_button_id",
      "label": "Button id",
      "default": "right_button"
    },
    {
      "type": "text",
      "id": "right_button_file",
      "label": "File url",
      "default": "/"
    }
  ]
}
{% endschema %}
